{% extends "base.html" %}

{% block content %}
<div class="p-6 max-w-3xl">
  <div class="flex items-center justify-between mb-4">
    <h1 class="text-2xl font-bold">Contract #{{ contract.id }}</h1>
    <div>
      <a href="/contracts/ui/{{ contract.id }}/edit" class="bg-yellow-500 text-white px-3 py-1 rounded mr-2">Edit</a>
      <button id="deleteBtn" class="bg-red-600 text-white px-3 py-1 rounded">Delete</button>
    </div>
  </div>

  <dl class="grid grid-cols-2 gap-4 bg-white p-4 rounded shadow">
    <div>
      <dt class="text-sm text-gray-500">Tenant</dt>
      <dd class="font-medium">{{ contract.tenant.name if contract.tenant else contract.tenant_id }}</dd>
    </div>
    <div>
      <dt class="text-sm text-gray-500">Room</dt>
      <dd class="font-medium">{{ contract.room.number if contract.room else contract.room_id }}</dd>
    </div>
    <div>
      <dt class="text-sm text-gray-500">Start Date</dt>
      <dd>{{ contract.start_date }}</dd>
    </div>
    <div>
      <dt class="text-sm text-gray-500">End Date</dt>
      <dd>{{ contract.end_date or '-' }}</dd>
    </div>
    <div>
      <dt class="text-sm text-gray-500">Rent</dt>
      <dd>{{ contract.rent_amount }}</dd>
    </div>
    <div>
      <dt class="text-sm text-gray-500">Active</dt>
      <dd>{{ 'Yes' if contract.active else 'No' }}</dd>
    </div>
  </dl>
</div>
{% endblock %}

<script>
document.getElementById('deleteBtn').addEventListener('click', async function(){
  if(!confirm('Delete this contract?')) return;
  const res = await fetch('/contracts/{{ contract.id }}', { method: 'DELETE' });
  if (res.status === 204) window.location.href = '/contracts/ui';
  else {
    const err = await res.json();
    alert(err.detail || 'Delete failed');
  }
});
</script>